<!DOCTYPE html>
<html lang="pt-pt" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clever Advertising - Dashboard N1</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@700&family=Figtree:wght@400;600&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        /* --- Design System --- */
        :root {
            /* Cores Base */
            --color-bg: #f4f4f4;
            --color-card-bg: #ffffff;
            --color-text: #24282A;
            --color-header-bg: #ffffff;
            --color-sidebar-bg: #ffffff;
            --color-header-text: #231372;
            --color-accent: #20E2C8;
            --color-border: #e0e0e0;
            
            /* Gráficos */
            --color-graphic-1: #231372;
            --color-graphic-2: #20E2C8;
            --color-graphic-3: #6106AF;
            
            /* Layout */
            --sidebar-width: 80px; /* Sidebar compacta para focar no conteúdo */
            --header-height: 90px;
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --color-bg: #121418;
            --color-card-bg: #1e2228;
            --color-text: #ecf0f1;
            --color-header-bg: #1e2228;
            --color-sidebar-bg: #1e2228;
            --color-header-text: #ffffff;
            --color-border: #2c3036;
        }

        /* Reset */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background-color: var(--color-bg);
            font-family: 'Figtree', sans-serif;
            color: var(--color-text);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- Layout --- */
        
        /* Sidebar (Navegação Prática) */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--color-sidebar-bg);
            border-right: 1px solid var(--color-border);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: var(--header-height); /* Espaço para o header fixo */
            position: fixed;
            height: 100vh;
            z-index: 90;
            transition: width 0.3s;
        }
        
        .sidebar:hover { width: 220px; } /* Expande ao passar o rato */

        .sidebar-menu { list-style: none; width: 100%; padding-top: 20px; }
        .sidebar-menu li { width: 100%; }
        
        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 15px 0;
            padding-left: 28px; /* Centralizar ícone quando fechado */
            color: #6c757d;
            text-decoration: none;
            transition: 0.2s;
            white-space: nowrap;
            overflow: hidden;
        }
        
        .sidebar-menu a i { 
            font-size: 1.2rem; 
            min-width: 24px; 
            margin-right: 20px; 
            text-align: center;
        }
        
        .sidebar-menu a:hover, .sidebar-menu a.active {
            color: var(--color-header-text);
            background-color: rgba(32, 226, 200, 0.15);
            border-right: 3px solid var(--color-accent);
        }
        [data-theme="dark"] .sidebar-menu a:hover { color: var(--color-accent); }

        .sidebar-text { opacity: 0; transition: opacity 0.2s; }
        .sidebar:hover .sidebar-text { opacity: 1; }

        /* Área Principal */
        .main-wrapper {
            flex: 1;
            margin-left: var(--sidebar-width);
            display: flex;
            flex-direction: column;
            width: calc(100% - var(--sidebar-width));
            transition: margin-left 0.3s, width 0.3s;
        }
        
        .sidebar:hover + .main-wrapper {
            /* Opcional: empurrar conteúdo ou sobrepor. Sobrepor é melhor para UX */
        }

        /* --- Header (Top Bar) --- */
        .top-header {
            height: var(--header-height);
            background-color: var(--color-header-bg);
            border-bottom: 1px solid var(--color-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
        }

        .brand-logo svg {
            height: 55px; /* Altura ajustada para o logo horizontal */
            width: auto;
        }
        
        /* Fix para cor do logo SVG no Dark Mode */
        [data-theme="dark"] .cls-text { fill: #ffffff !important; }

        /* --- Conteúdo --- */
        .content { padding: 30px 40px; }

        h1 { 
            font-family: 'Barlow', sans-serif; 
            color: var(--color-header-text); 
            font-size: 1.8rem; 
            margin-bottom: 5px;
        }
        [data-theme="dark"] h1 { color: var(--color-accent); }

        /* Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--color-card-bg);
            padding: 25px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }
        
        .card-val { font-family: 'Barlow', sans-serif; font-size: 2rem; font-weight: 700; color: var(--color-header-text); }
        [data-theme="dark"] .card-val { color: #fff; }
        
        .card-lbl { font-size: 0.85rem; color: #6c757d; text-transform: uppercase; font-weight: 600; }
        
        /* Charts */
        .charts-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        @media(max-width:1000px){ .charts-row { grid-template-columns: 1fr; } }
        
        .chart-box {
            background: var(--color-card-bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            height: 400px;
        }

        /* Tabela */
        .table-box {
            background: var(--color-card-bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            overflow-x: auto;
        }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; white-space: nowrap; }
        th { text-align: left; padding: 12px; background: rgba(35, 19, 114, 0.05); color: var(--color-header-text); font-family: 'Barlow'; text-transform: uppercase; }
        [data-theme="dark"] th { background: rgba(255,255,255,0.05); color: var(--color-accent); }
        td { padding: 12px; border-bottom: 1px solid var(--color-border); }
        
        /* Switch Theme */
        .theme-switch { display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .switch-btn { width: 40px; height: 20px; background: #ccc; border-radius: 20px; position: relative; transition: 0.3s; }
        .switch-btn::after { content:''; position: absolute; left: 2px; top: 2px; width: 16px; height: 16px; background: white; border-radius: 50%; transition: 0.3s; }
        input:checked + .switch-btn { background: var(--color-accent); }
        input:checked + .switch-btn::after { left: 22px; }

        /* SVG Classes Fixas */
        .cls-1{fill:none;}.cls-3{fill:url(#Gradiente_sem_nome_10);}.cls-4{fill:#24282a;}.cls-text{fill:#24282a;transition:fill 0.3s;}
    </style>
</head>
<body>

    <nav class="sidebar">
        <ul class="sidebar-menu">
            <li><a href="#" class="active"><i class="fas fa-chart-line"></i> <span class="sidebar-text">Dashboard</span></a></li>
            <li><a href="#"><i class="fas fa-list-ul"></i> <span class="sidebar-text">Detalhes N1</span></a></li>
            <li><a href="#"><i class="fas fa-history"></i> <span class="sidebar-text">Histórico</span></a></li>
            <li><a href="#"><i class="fas fa-cog"></i> <span class="sidebar-text">Definições</span></a></li>
        </ul>
    </nav>

    <div class="main-wrapper">
        <header class="top-header">
            <div class="brand-logo">
                <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 837.7 245.66">
                    <defs>
                        <linearGradient id="Gradiente_sem_nome_10" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" stop-color="#231372"/>
                            <stop offset="100%" stop-color="#20E2C8"/> </linearGradient>
                    </defs>
                    <path class="cls-text" d="M452.05,129.69v18.74c0,1.99-1.61,3.6-3.6,3.6h-67.98c-1.99,0-3.6-1.61-3.6-3.6h0V42.63c0-1.99,1.61-3.6,3.6-3.6h20.9c1.99,0,3.6,1.61,3.6,3.6h0v83.46h43.47c1.99,0,3.6,1.61,3.61,3.59h0Z"/>
                    <path class="cls-text" d="M821.22,116.37l-2.89-5.46c17.91-12.4,22.38-36.97,9.99-54.88-7.37-10.65-19.49-17-32.44-17h-41.65c-1.99,0-3.6,1.61-3.6,3.6v105.8c0,1.99,1.61,3.6,3.6,3.6h20.81c2.04,0,3.7-1.66,3.7-3.7v-30.56c0-.77.63-1.4,1.4-1.4h8.8c.52,0,1,.29,1.24.75l.23.43,17.21,32.51c.64,1.22,1.91,1.98,3.29,1.98h23.18c2,0,3.62-1.63,3.62-3.63,0-.59-.15-1.17-.42-1.69l-16.06-30.34ZM805.1,85.93c-2.59,4.22-7.18,6.79-12.13,6.78h-14.24v-28.46h14.9v.02c7.86.37,13.93,7.03,13.56,14.89-.11,2.4-.83,4.73-2.09,6.78h0Z"/>
                    <path class="cls-text" d="M370.4,140.66c.53.99.24,2.22-.67,2.87-26.46,18.91-63.23,12.79-82.14-13.66-18.91-26.46-12.79-63.23,13.66-82.14,20.48-14.64,47.99-14.64,68.47,0,.91.66,1.19,1.88.67,2.88l-10.45,19.73c-.93,1.76-3.11,2.42-4.87,1.49-.2-.1-.38-.23-.55-.36-13.36-10.51-32.71-8.21-43.22,5.15-10.51,13.36-8.21,32.71,5.15,43.22,11.17,8.79,26.91,8.79,38.08,0,1.55-1.24,3.82-.99,5.06.57.14.17.26.36.37.56l10.44,19.73Z"/>
                    <path class="cls-text" d="M487.03,64.97v18.73h37.96c1.99,0,3.6,1.61,3.6,3.6v16.46c0,1.99-1.61,3.6-3.6,3.6h-37.96v18.73h49.15c1.99,0,3.6,1.61,3.6,3.6v18.74c0,1.99-1.61,3.6-3.6,3.6h-73.66c-1.99,0-3.6-1.61-3.6-3.6V42.63c0-1.99,1.61-3.6,3.6-3.6h73.66c1.99,0,3.6,1.61,3.6,3.6v18.65c0,2.04-1.65,3.69-3.69,3.69h-49.06Z"/>
                    <path class="cls-text" d="M691.37,64.97v18.73h37.96c1.99,0,3.6,1.61,3.6,3.6v16.46c0,1.99-1.61,3.6-3.6,3.6h-37.96v18.73h49.15c1.99,0,3.6,1.61,3.6,3.6v18.74c0,1.99-1.61,3.6-3.6,3.6h-73.66c-1.99,0-3.6-1.61-3.6-3.6V42.63c0-1.99,1.61-3.6,3.6-3.6h73.66c1.99,0,3.6,1.61,3.6,3.6v18.65c0,2.04-1.65,3.69-3.69,3.69h-49.06Z"/>
                    <path class="cls-text" d="M310.46,207.36c0,.24-.09.46-.27.62h-6.76c-.33,0-.66-.11-.92-.32l-1.57-4.57h-12.07l-1.55,4.55c-.09.33-.29.62-.57.82h-6.74c-.28.02-.55-.06-.77-.23l12.72-32.27c.14-.34.38-.64.68-.86h5.02c.34,0,.67.12.94.32l12.69,32.29c.07.17.11.36.12.55M297.1,195.31l-3.6-10.55-3.6,10.55h7.2Z"/>
                    <path class="cls-text" d="M338.14,174.64c0-.34.13-.66.37-.89h10.81c3.16-.05,6.28.71,9.06,2.23,2.61,1.44,4.77,3.58,6.23,6.19,1.52,2.76,2.29,5.86,2.24,9.01.05,3.14-.72,6.23-2.24,8.98-1.46,2.6-3.61,4.74-6.23,6.17-2.78,1.51-5.9,2.27-9.06,2.21h-10.81c-.7,0-1.26-.56-1.26-1.26h0v-32.27ZM350.21,199.97c3.23.04,6.21-1.71,7.74-4.55.77-1.42,1.16-3.01,1.14-4.62.02-1.66-.37-3.3-1.14-4.76-1.5-2.87-4.5-4.65-7.74-4.59l-3.43.02v18.5h3.43Z"/>
                    <path class="cls-text" d="M425.13,173.56c.18.15.28.38.26.62h0l-12.72,32.27c-.13.35-.36.65-.65.87-.27.21-.6.32-.94.32h-5.02c-.35,0-.68-.12-.95-.33l-12.67-32.29c-.07-.17-.11-.36-.12-.55,0-.23.09-.46.26-.61h0c.22-.16.49-.25.76-.23h6.76c.34,0,.67.11.94.32l7.55,21,7.67-21.05c.1-.34.31-.63.6-.83h6.76"/>
                    <path class="cls-text" d="M452.9,174.64c-.02-.34.1-.68.33-.93h22.4c.34-.02.68.1.93.33v5.48c.02.34-.1.67-.32.93h-15.12v5.76h11.48c.37-.02.73.1,1.01.35v4.53c.02.35-.12.69-.37.93h-11.48v5.93h15.12c.47-.03.92.13,1.27.44v5.14c.02.34-.11.66-.35.9h-22.85c-.34.02-.67-.09-.93-.32v-32.29Z"/>
                    <path class="cls-text" d="M534.29,207.26c0,.51-.4.92-.9.93h-7.12c-.29.02-.58-.06-.82-.23l-5.1-9.81h-3.55v9.62c.02.34-.11.68-.35.93h-6.1c-.34.02-.67-.1-.92-.33v-32.29c-.01-.34.11-.66.35-.9h12.22c2.26-.04,4.49.47,6.5,1.49,1.85.95,3.38,2.42,4.42,4.23,1.09,1.94,1.64,4.14,1.59,6.36.03,2.04-.46,4.06-1.42,5.86-.92,1.71-2.29,3.13-3.96,4.12l6.1,11.31M516.12,189.85h4.45c.77.01,1.52-.2,2.18-.6.64-.39,1.16-.95,1.51-1.62.37-.69.56-1.46.55-2.24.01-.76-.18-1.51-.55-2.18-.35-.63-.88-1.15-1.51-1.5h-4.45v8.67Z"/>
                    <path class="cls-text" d="M561.13,174.64c-.02-.34.1-.68.33-.93h23.24c.34-.02.68.1.93.33v5.74c.02.35-.1.68-.33.94h-7.31v25.55c.02.35-.1.69-.33.94h-6.1c-.64.06-1.2-.4-1.26-1.04v-25.55h-7.29c-.34.02-.68-.1-.93-.35v-5.74Z"/>
                    <path class="cls-text" d="M623.9,207.24c.07.44-.23.86-.68.93h-6.79c-.46.06-.87-.27-.93-.73v-32.94c-.06-.44.26-.85.7-.9h6.79c.44-.06.84.25.9.69v32.94Z"/>
                    <path class="cls-text" d="M652.91,204.31c.01-.3.1-.6.26-.86l2.81-5.05c.2-.41.62-.67,1.07-.67.27.01.54.08.79.19,1.47.68,2.99,1.24,4.55,1.68,1.51.41,3.06.61,4.62.61,1.06.03,2.12-.21,3.06-.7.75-.34,1.24-1.07,1.25-1.89,0-.58-.25-1.13-.7-1.5-.6-.49-1.27-.86-2-1.12-.87-.33-2.09-.73-3.66-1.19-2.07-.58-4.08-1.36-6-2.34-1.43-.74-2.65-1.83-3.54-3.18-.87-1.47-1.29-3.15-1.22-4.86-.05-2.05.57-4.07,1.76-5.74,1.2-1.62,2.82-2.88,4.69-3.63,2.01-.83,4.17-1.25,6.35-1.23,1.47,0,2.94.17,4.37.5,1.37.3,2.71.73,4.01,1.26,1.03.42,2.02.93,2.95,1.52.41.21.68.62.71,1.07l-2.83,5.14c-.17.38-.56.62-.98.62-.37-.02-.73-.13-1.05-.31-1.18-.62-2.41-1.14-3.68-1.56-1.23-.37-2.51-.55-3.8-.54-.91-.02-1.81.2-2.6.64-.64.29-1.07.92-1.1,1.62,0,.7.47,1.3,1.41,1.8,1.45.69,2.97,1.25,4.53,1.65,2.14.6,4.22,1.37,6.24,2.3,1.52.71,2.84,1.79,3.83,3.14,1.03,1.52,1.53,3.33,1.45,5.16.04,2.1-.58,4.15-1.79,5.87-1.23,1.71-2.91,3.04-4.86,3.85-2.15.91-4.46,1.36-6.79,1.33-2.35,0-4.68-.31-6.95-.9-2.2-.56-4.31-1.43-6.26-2.6"/>
                    <path class="cls-text" d="M717.37,207.24c.07.44-.23.86-.68.93h-6.79c-.46.06-.87-.27-.93-.73v-32.94c-.06-.44.26-.85.7-.9h6.79c.44-.06.84.24.9.68v32.94Z"/>
                    <path class="cls-text" d="M778.6,173.61c.17.19.26.44.24.69v32.96c.02.26-.07.51-.25.69-.19.17-.43.25-.68.24h-6.48c-.75,0-1.45-.41-1.81-1.07l-13.38-20.36v20.5c.02.25-.07.51-.25.69-.19.17-.43.25-.68.24h-6.79c-.25.01-.49-.07-.68-.24v-32.95c-.02-.25.07-.51.25-.69h7.03c.75.04,1.42.46,1.79,1.12l12.88,19.15v-19.34c-.02-.25.07-.5.24-.69h6.79"/>
                    <path class="cls-text" d="M827.49,200.03c.61-.16,1.2-.37,1.76-.66v-6.14c-.01-.34.12-.67.37-.91.24-.23.56-.36.89-.36h5.98c.32,0,.64.13.86.37v11.36c0,.26-.07.51-.19.74-.1.23-.27.42-.48.55-1.63.97-3.4,1.7-5.25,2.14-1.96.55-3.98.85-6.01.88-3.24.03-6.43-.79-9.24-2.4-2.75-1.56-5.04-3.82-6.63-6.55-1.63-2.77-2.47-5.93-2.44-9.15-.04-6.48,3.42-12.47,9.05-15.67,2.81-1.61,6-2.44,9.24-2.41,1.91.02,3.81.34,5.62.94,1.76.51,3.41,1.35,4.86,2.47.33.23.53.62.52,1.02l-3.5,5.26c-.19.32-.53.51-.91.5-.3,0-.59-.1-.81-.31-.78-.65-1.68-1.13-2.64-1.44-.93-.33-1.92-.5-2.91-.51-1.71-.02-3.39.42-4.88,1.26-1.45.82-2.66,2-3.5,3.44-1.71,2.96-1.71,6.61,0,9.57.84,1.44,2.05,2.62,3.5,3.44,1.49.84,3.17,1.28,4.88,1.26"/>

                    <path class="cls-text" d="M656.55,42.1l-42.22,107.61c-.55,1.4-1.9,2.32-3.41,2.32h-18.86c-1.51,0-2.86-.92-3.41-2.32l-42.22-107.61c-.45-1.15.11-2.46,1.27-2.91.26-.1.54-.16.82-.16h24.31c1.54,0,2.92.96,3.45,2.41l25.21,69.57,15.99-44.09c.27-.74-.12-1.55-.85-1.82-.15-.06-.32-.08-.48-.08h-15.82c-1.24,0-2.25-1-2.25-2.25,0-.26.05-.52.13-.77l7.45-20.56c.53-1.45,1.9-2.41,3.44-2.41h45.35c1.24,0,2.25,1.01,2.25,2.25,0,.28-.05.56-.16.82"/>
                    <path class="cls-3" d="M239.71,6.67l-91.78,233.94c-1.2,3.05-4.14,5.05-7.41,5.05h-41c-3.27,0-6.21-2.01-7.41-5.05L.34,6.67C-.64,4.16.59,1.32,3.1.34,3.67.11,4.28,0,4.89,0h52.84c3.35,0,6.34,2.1,7.48,5.25l54.82,151.23,34.75-95.85c.58-1.6-.25-3.37-1.85-3.95-.34-.12-.69-.19-1.05-.18h-34.39c-2.7,0-4.88-2.19-4.88-4.88,0-.57.1-1.13.29-1.66l16.2-44.7c1.14-3.15,4.13-5.25,7.49-5.25h98.59c2.7,0,4.88,2.19,4.88,4.88,0,.61-.11,1.22-.34,1.78"/>
                </svg>
            </div>
            
            <div class="theme-switch">
                <label>
                    <input type="checkbox" id="theme-toggle" style="display:none;">
                    <div class="switch-btn"></div>
                </label>
                <i class="fas fa-moon" style="color: #6c757d;"></i>
            </div>
        </header>

        <main class="content">
            <div style="margin-bottom: 30px;">
                <h1>Dashboard <span style="color:var(--color-accent);">N1</span></h1>
                <p style="color: #6c757d;">Análise de Performance - 2024/2025</p>
            </div>

            <section class="cards-grid">
                <div class="card">
                    <div class="card-lbl">Média N1 (Global)</div>
                    <div class="card-val" id="kpi-global">--</div>
                    <div style="font-size:0.8rem; color:#20E2C8;">Horas</div>
                </div>
                <div class="card">
                    <div class="card-lbl">Maior Tempo</div>
                    <div class="card-val" id="kpi-slow" style="color:#e74c3c;">--</div>
                    <div style="font-size:0.8rem;" id="kpi-slow-lbl">-</div>
                </div>
                <div class="card">
                    <div class="card-lbl">Categorias</div>
                    <div class="card-val" id="kpi-count">--</div>
                    <div style="font-size:0.8rem;">Ativas</div>
                </div>
            </section>

            <section class="charts-row">
                <div class="chart-box">
                    <canvas id="trendChart"></canvas>
                </div>
                <div class="chart-box">
                    <canvas id="barChart"></canvas>
                </div>
            </section>

            <section class="table-box">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>Categoria</th>
                            <th>Área</th>
                            <th>Média N1</th>
                            <th>Q1 '24</th>
                            <th>Q2 '24</th>
                            <th>Q3 '24</th>
                            <th>Q4 '24</th>
                            <th>Q1 '25</th>
                            <th>Q2 '25</th>
                            <th>Q3 '25</th>
                            <th>Q4 '25</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
        </main>
    </div>

    <script>
        // --- Dados (Processados do CSV N1 - SLO) ---
        const detailsData = [
            {"Category": "Access", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.01, "Q1_2025": 0.0, "Q2_2025": 16.65, "Q3_2025": 12.66, "Q4_2025": 17.71, "Average_N1": 15.68, "Area": "Infra"},
            {"Category": "Acessories / Notebook", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 342.59, "Q2_2025": 21.78, "Q3_2025": 68.82, "Q4_2025": 10.58, "Average_N1": 110.94, "Area": "Infra"},
            {"Category": "Advertising", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 1.12, "Q3_2025": 1.79, "Q4_2025": 0.0, "Average_N1": 0.97, "Area": "Service"},
            {"Category": "CleverAds", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.52, "Q3_2025": 0.51, "Q4_2025": 0.0, "Average_N1": 0.34, "Area": "Service"},
            {"Category": "Traffic", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 1.96, "Q3_2025": 1.59, "Q4_2025": 0.0, "Average_N1": 1.18, "Area": "Service"},
            {"Category": "Implementation", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 2.16, "Q3_2025": 1.67, "Q4_2025": 0.0, "Average_N1": 1.28, "Area": "Service"},
            {"Category": "Resolution AUTO", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.0, "Q3_2025": 66.67, "Q4_2025": 1.86, "Average_N1": 22.84, "Area": "Service"},
            {"Category": "Jira /Confluence", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.23, "Q3_2025": 0.25, "Q4_2025": 0.0, "Average_N1": 0.16, "Area": "Service"},
            {"Category": "PowerBI", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 6.11, "Q3_2025": 66.17, "Q4_2025": 0.0, "Average_N1": 24.09, "Area": "Service"},
            {"Category": "Network", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 1.21, "Q3_2025": 1.80, "Q4_2025": 0.0, "Average_N1": 1.00, "Area": "Infra"},
            {"Category": "Printer", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.0, "Q3_2025": 2.05, "Q4_2025": 0.0, "Average_N1": 0.68, "Area": "Infra"},
            {"Category": "B2B / Approvals / Commission", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 5.32, "Q3_2025": 0.60, "Q4_2025": 0.0, "Average_N1": 1.97, "Area": "Core"},
            {"Category": "Antivirus", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.17, "Q3_2025": 0.29, "Q4_2025": 0.0, "Average_N1": 0.15, "Area": "Infra"},
            {"Category": "Improvement", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.0, "Q3_2025": 485.77, "Q4_2025": 193.79, "Average_N1": 339.78, "Area": "Service"},
            {"Category": "RPA", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 28.06, "Q3_2025": 78.97, "Q4_2025": 0.0, "Average_N1": 53.52, "Area": "Delivery"},
            {"Category": "Biometric Control", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 54.94, "Q3_2025": 33.97, "Q4_2025": 31.51, "Average_N1": 40.14, "Area": "Corporate"},
            {"Category": "New Services", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 2.05, "Q3_2025": 2.31, "Q4_2025": 0.0, "Average_N1": 1.45, "Area": "Core"},
            {"Category": "New Solution Request", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 5.81, "Q3_2025": 5.26, "Q4_2025": 16.91, "Average_N1": 9.33, "Area": "Service"},
            {"Category": "Data Base", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.0, "Q3_2025": 2.17, "Q4_2025": 0.0, "Average_N1": 0.72, "Area": "Infra"},
            {"Category": "Information Security", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.0, "Q3_2025": 0.28, "Q4_2025": 0.0, "Average_N1": 0.09, "Area": "Infra"}
        ];

        const top5Data = [
            {"Category": "Improvement", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 0.0, "Q3_2025": 485.77, "Q4_2025": 193.79},
            {"Category": "Acessories / Notebook", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 342.59, "Q2_2025": 21.78, "Q3_2025": 68.82, "Q4_2025": 10.58},
            {"Category": "RPA", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 28.06, "Q3_2025": 78.97, "Q4_2025": 0.0},
            {"Category": "Biometric Control", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 54.94, "Q3_2025": 33.97, "Q4_2025": 31.51},
            {"Category": "PowerBI", "Q1_2024": 0.0, "Q2_2024": 0.0, "Q3_2024": 0.0, "Q4_2024": 0.0, "Q1_2025": 0.0, "Q2_2025": 6.11, "Q3_2025": 66.17, "Q4_2025": 0.0}
        ];

        // --- Lógica ---
        const toggle = document.getElementById('theme-toggle');
        const body = document.body;
        let trendChart, barChart;

        // Init
        (function(){
            populateCards();
            initCharts();
            initTable();
            toggle.addEventListener('change', () => {
                const isDark = toggle.checked;
                body.setAttribute('data-theme', isDark ? 'dark' : 'light');
                updateCharts(isDark);
            });
        })();

        function populateCards() {
            document.getElementById('kpi-global').innerText = '49.19';
            const sorted = [...detailsData].sort((a,b) => b.Average_N1 - a.Average_N1);
            document.getElementById('kpi-slow').innerText = sorted[0].Average_N1;
            document.getElementById('kpi-slow-lbl').innerText = sorted[0].Category;
            document.getElementById('kpi-count').innerText = detailsData.length;
        }

        function initCharts() {
            const ctxT = document.getElementById('trendChart').getContext('2d');
            const ctxB = document.getElementById('barChart').getContext('2d');
            const labels = ['Q1 24','Q2 24','Q3 24','Q4 24','Q1 25','Q2 25','Q3 25','Q4 25'];
            const colors = ['#231372','#20E2C8','#6106AF','#E74C3C','#F1C40F'];

            trendChart = new Chart(ctxT, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: top5Data.map((d,i) => ({
                        label: d.Category,
                        data: [d.Q1_2024,d.Q2_2024,d.Q3_2024,d.Q4_2024,d.Q1_2025,d.Q2_2025,d.Q3_2025,d.Q4_2025],
                        borderColor: colors[i%5],
                        backgroundColor: colors[i%5],
                        tension: 0.3,
                        fill: false
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } },
                    scales: { y: { beginAtZero: true, grid:{color:'#e0e0e0'} }, x: { grid:{display:false} } }
                }
            });

            const barData = [...detailsData].sort((a,b) => b.Average_N1 - a.Average_N1).slice(0,10);
            barChart = new Chart(ctxB, {
                type: 'bar',
                data: {
                    labels: barData.map(d => d.Category),
                    datasets: [{
                        label: 'Horas',
                        data: barData.map(d => d.Average_N1),
                        backgroundColor: '#20E2C8',
                        borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true, grid:{color:'#e0e0e0'} }, y: { grid:{display:false} } }
                }
            });
        }

        function updateCharts(isDark) {
            const color = isDark ? '#fff' : '#24282A';
            const grid = isDark ? '#2c3036' : '#e0e0e0';
            [trendChart, barChart].forEach(c => {
                if(!c) return;
                c.options.scales.x.ticks.color = color;
                c.options.scales.y.ticks.color = color;
                c.options.scales.x.grid.color = grid;
                c.options.scales.y.grid.color = grid;
                c.options.plugins.legend.labels.color = color;
                c.update();
            });
        }

        function initTable() {
            const tb = document.querySelector('#dataTable tbody');
            let html = '';
            detailsData.forEach(r => {
                html += `<tr>
                    <td style="font-weight:600;">${r.Category}</td>
                    <td>${r.Area}</td>
                    <td style="font-weight:700;color:#231372;">${r.Average_N1}</td>
                    <td>${r.Q1_2024}</td><td>${r.Q2_2024}</td><td>${r.Q3_2024}</td><td>${r.Q4_2024}</td>
                    <td>${r.Q1_2025}</td><td>${r.Q2_2025}</td><td>${r.Q3_2025}</td><td>${r.Q4_2025}</td>
                </tr>`;
            });
            tb.innerHTML = html;
        }
    </script>
</body>
</html>
